---
import Docs from '../../../layouts/Docs.astro';
---

<Docs title="Windows Installation">
  <h2>Prerequisites</h2>
  <ul>
    <li>Windows 10 / 11 64-bit</li>
    <li>Python 3.12.x (exact minor version must match the renderdoc <code>.pyd</code>)</li>
    <li>Visual Studio 2022 Build Tools with "Desktop development with C++" workload</li>
    <li>Git (for building renderdoc from source)</li>
  </ul>

  <h2>Install rdc-cli</h2>
  <pre><code>pip install rdc-cli</code></pre>
  <p>
    This installs the <code>rdc</code> command. You still need the renderdoc
    Python module &mdash; see below.
  </p>

  <h2>RenderDoc Python Module</h2>
  <p>
    The renderdoc Python module (<code>renderdoc.cpython-3*.pyd</code>) is
    <strong>not</strong> available on PyPI. Your Python minor version must
    exactly match the one used to compile the module.
  </p>

  <h3>Option A: RenderDoc Installer</h3>
  <p>
    Download and install
    <a href="https://renderdoc.org/builds">RenderDoc for Windows</a>.
    The installer places <code>renderdoc.dll</code> in
    <code>C:\Program Files\RenderDoc</code>. The Python bindings
    (<code>.pyd</code>) may be included depending on the installer version.
  </p>

  <h3>Option B: Build from Source</h3>
  <p>
    A cross-platform build script is planned for Phase W2. In the meantime,
    see <code>scripts/build_renderdoc.py</code> (coming in Phase W2) or
    build manually:
  </p>
  <pre><code>git clone --depth 1 https://github.com/baldurk/renderdoc.git
cd renderdoc
cmake -B build -G "Visual Studio 17 2022" -DENABLE_PYRENDERDOC=ON -DENABLE_QRENDERDOC=OFF
cmake --build build --config Release
set RENDERDOC_PYTHON_PATH=%cd%\build\lib\Release</code></pre>

  <h2>Configure RENDERDOC_PYTHON_PATH</h2>
  <p>
    Set the environment variable to point at the directory containing the
    <code>.pyd</code> file:
  </p>
  <pre><code>set RENDERDOC_PYTHON_PATH=C:\path\to\renderdoc\build\lib</code></pre>
  <p>
    To make it permanent, add it via
    <strong>System Properties &rarr; Environment Variables</strong>.
  </p>

  <h2>Validate with rdc doctor</h2>
  <pre><code>rdc doctor</code></pre>
  <p>
    A successful output on Windows shows 8 checks, including the three
    Windows-specific checks:
  </p>
  <ul>
    <li><code>win-python-version</code> &mdash; Python version matches <code>.pyd</code></li>
    <li><code>win-vs-build-tools</code> &mdash; Visual Studio Build Tools detected</li>
    <li><code>win-renderdoc-install</code> &mdash; RenderDoc <code>.dll</code> found</li>
  </ul>

  <h2>Known Limitations</h2>
  <ul>
    <li>
      Daemon process management (<code>rdc session start</code>) is not yet
      functional on Windows. Phase W2 will implement the required OS-level
      process APIs.
    </li>
    <li>
      All analysis commands (<code>rdc open</code>, <code>rdc info</code>,
      <code>rdc shaders</code>, etc.) will work once the daemon is running.
    </li>
  </ul>

  <h2>Troubleshooting</h2>
  <h3>Python version mismatch</h3>
  <p>
    If <code>rdc doctor</code> reports a version mismatch between your
    running Python and the <code>.pyd</code>, install the matching Python
    version or rebuild renderdoc with your current Python.
  </p>

  <h3>renderdoc module not found</h3>
  <p>
    Ensure <code>RENDERDOC_PYTHON_PATH</code> points to the directory
    containing <code>renderdoc.pyd</code> (not <code>renderdoc.dll</code>).
  </p>

  <h3>vswhere.exe not found</h3>
  <p>
    Install <a href="https://visualstudio.microsoft.com/downloads/#build-tools-for-visual-studio-2022">
    Visual Studio 2022 Build Tools</a> with the "Desktop development with
    C++" workload selected.
  </p>
</Docs>
