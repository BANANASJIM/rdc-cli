[workspace]
name = "rdc-cli"
channels = ["conda-forge"]
platforms = ["linux-64", "osx-arm64", "osx-64"]

[dependencies]
python = "3.14.*"
uv = ">=0.5"

[activation.env]
RENDERDOC_PYTHON_PATH = ".local/renderdoc"
PYTHONPATH = "src"

[tasks]
sync = "uv sync --extra dev && git config core.hooksPath .githooks && bash scripts/ensure-renderdoc.sh"
setup-renderdoc = "bash scripts/setup-renderdoc.sh"
lint = "uv run ruff check src tests && uv run ruff format --check src tests"
typecheck = "uv run mypy src"
test = "uv run pytest tests/unit -v --cov=rdc --cov-report=term-missing --cov-fail-under=80"
test-gpu = "uv run pytest tests -v -m gpu --no-header"
test-all = "uv run pytest tests -v --cov=rdc --cov-report=term-missing"
check = "pixi run lint && pixi run typecheck && pixi run test"
gen-skill-ref = "bash -c 'uv run python scripts/gen-skill-ref.py > .claude/skills/rdc-cli/references/commands-quick-ref.md'"
check-skill-ref = "bash -c 'diff <(uv run python scripts/gen-skill-ref.py) .claude/skills/rdc-cli/references/commands-quick-ref.md'"
verify = "bash scripts/verify-package.sh"
e2e = "bash scripts/e2e-test.sh"
